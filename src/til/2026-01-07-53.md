---
title: 교착 상태
description: 교착 상태란 무엇일까요?
date: 2026-01-07
tags: [교착 상태]
---

교착 상태(Deadlock, 데드락)는 두 개 이상의 프로세스나 스레드가 서로 상대방이 가진 자원을 기다리며, 결과적으로 아무도 작업을 진행하지 못하고 무한히 대기하는 상태를 말합니다.

쉽게 말해 “꽉 막힌 상태”입니다. 좁은 골목길에서 서로 마주 선 두 자동차가 “네가 비켜야 내가 가지”라며 버티고 있어서, 영원히 아무도 못 지나가는 상황과 같습니다.

## 1. 교착 상태 발생 조건

교착 상태가 발생하려면 다음 4가지 조건이 모두 동시에 성립해야 합니다. (이 중 하나라도 깨지면 교착 상태는 발생하지 않습니다.)

1. 상호 배제
   - 자원은 한 번에 하나의 프로세스만 사용할 수 있어야 합니다. (공유 불가능한 자원)
2. 점유 대기
   - 자원을 최소한 하나 보유하고 있으면서, 다른 프로세스가 사용 중인 자원을 추가로 기다리는 상태여야 합니다.
3. 비선점
   - 다른 프로세스가 이미 보유한 자원을 강제로 뺏어올 수 없어야 합니다. 자원을 가진 프로세스가 스스로 내놓을 때까지 기다려야 합니다.
4. 순환 대기
   - 대기 프로세스의 집합이 순환 형태를 이뤄야 합니다.
   - 예: A는 B의 자원을, B는 C의 자원을, C는 A의 자원을 기다리는 꼬리 물기 상황

## 2. 발생 예시

가장 흔한 예시는 두 개의 쓰레드가 두 개의 자원을 서로 다른 순서로 요청할 때 발생합니다.

- Thaead 1: Lock A 획득 → (작업 중) → Lock B 요청 (대기)
- Thaead 2: Lock B 획득 → (작업 중) → Lock A 요청 (대기)

이때 Thread 1은 B를 기다리고, Thread 2는 A를 기다리는데, 서로 쥐고 있는 것을 놓지 않으므로(비선점) 영원히 멈추게 됩니다.

## 3. 교착 상태 해결 방법

교착 상태를 다루는 방법은 크게 4가지 전략으로 나뉩니다.

### 예방

교착 상태 발생 조건 4가지 중 하나를 원천적으로 차단하는 방법입니다. 가장 강력하지만 자원 낭비가 심할 수 있습니다.

- 상호 배제 부정: 자원을 공유 가능하게 만듦 (현실적으로 어려움)
- 점유 대기 부정: 프로세스 시작 시 필요한 모든 자원을 한꺼번에 할당받게 함
- 비선점 부정: 자원을 뺏어올 수 있게함
- 순환 대기 부정: 자원에 고유 번호를 매기고, 번호 순서대로만 자원을 요청하게 함 (가장 많이 쓰임)

### 회피

교착 상태가 발생할 가능성이 있는 자원 할당 요청은 아예 거절하는 방식입니다.

- 은행원 알고리즘: 자원을 빌려줘도 시스템이 “안전 상태”에 머물 수 있는지를 미리 계산합니다. 만약 교착 상태 위험이 있다면, 자원이 남아있어도 할당해주지 않고 대기시킵니다.

### 탐지 및 회복

교착 상태 발생을 허용하되, 주기적으로 검사하여 발견되면 해결하는 방식입니다.

- 탐지: 자원 할당 그래프를 통해 순환 대기가 있는지 감시합니다.
- 회복
  - 프로세스 종료: 교착 상태에 빠진 프로세스를 모두 죽이거나, 하나씩 죽여가며 풀릴 때까지 반복합니다.
  - 자원 선점: 교착 상태의 프로세스로부터 자원을 강제로 뺏어 다른 놈에게 줍니다.

### 무시 - 타조 알고리즘

- “아몰랑” 전략입니다.
- 교착 상태는 드물게 발생하며, 이를 해결하는 비용이 더 크다고 판단하여, 그냥 발생하면 사용자에게 재부팅하게 둡니다.
- 현대의 대부분의 운영체제가 채택한 방식입니다.

## 정리

교착 상태는 “서로 가진 것을 놓지 않으면서 상대방 것을 탐낼 때 발생하는 무한 대기”입니다. 이를 해결하기 위해 예방, 회피, 탐지 등의 기법이 있지만, 비용 문제로 인해 실제로는 조심해서 코딩(Lock 순서 일치 등)하고 문제 발생 시 재시작하는 경우가 많습니다.
